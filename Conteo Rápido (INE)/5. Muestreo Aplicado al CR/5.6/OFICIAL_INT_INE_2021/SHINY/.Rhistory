# (SIEMPRE LOCAL) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
my_dir <- "C:/R_Apps/OFICIAL_INT_INE_2021/ESTIMACION/"
source(paste0(my_dir, "1extras_precarga.r"),encoding = "utf-8")
# Esta función hace lo necesario.
estima_imput_edgar <- function(DIA="0006",HORA){
# 1- LEE REMESA
# DIA <- "0029"
# HORA <- "1740"
res_lee <- lee_remesa_tot(my_dir_rem, DIA, HORA, my_variables, ID_EDO_DIST)
# 2- IMPUTACIÓN
pred <- crea_pred_mat(res_lee$REMESA)
m0 <- 5
res_imp <- mice(
res_lee$REMESA,
pred = pred,
method = "pmm",
m = m0,
print = FALSE
)
# DIAGNÓSTICOS VISUALES
BD_SAMPLE0 <- res_lee$REMESA0
BD_REMESA <- res_lee$REMESA0[res_lee$id_na, ]
# 3- ESTIMO CON CADA UNA DE LAS m0 BASES
cores <- 8             # CORES QUE VOY A USAR
B <- 250               # NUMERO DE REPLICAS BOOTSTRAP
res_est_bases <- estima_bases_imput(cores,
B,
m0,
res_imp,
my_contendientes,
my_partidos,
INFO_COAL,
INFO_BOOT_IMPUT)
# 4- COMBINO LAS ETIMACIONES REALIZADAS CON LAS m0 IMPUTACIONES
pp <- res_lee$n/nrow(res_lee$REMESA)
pc <- 1/pp
aalpha <- 0.05
res_fin <- combina_imputaciones(aalpha, res_est_bases, pc)
# 5- GUARDA
# ESTO DEPENDE DE LO QUE ESTÁ EN 1extras_precarga.r (PUEDE SER LOCAL/ONLINE)
guarda_resultados_cartografia(res_fin, DIA, HORA, my_dir_carto_conf, my_dir_carto_vve)
# # ONLINE-EXCLUSIVO (Descomentar si se desea guardar en Buzón)
# try(guarda_resultados_buzon(res_fin, DIA, HORA, my_dir_buzon))
# try(calcula_y_guarda_compulsado(res_lee$nh, DIA, HORA, my_dir_buzon, my_dir_comp_vve, my_dir_comp_conf)) # NO DESCOMENTAR. NO GUARDAREMOS COMPULSADO, esto lo hará Luis Enrique.
}
# De aquí vienen los archivos
my_dir_rem # ESTO DEPENDE DE LO QUE ESTÁ EN 1extras_precarga.r (PUEDE SER LOCAL/ONLINE)
# Estos son nuestros archivos disponibles
list.files(my_dir_rem)
# De aquí vienen los archivos
my_dir_rem # ESTO DEPENDE DE LO QUE ESTÁ EN 1extras_precarga.r (PUEDE SER LOCAL/ONLINE)
# Estos son nuestros archivos disponibles
list.files(my_dir_rem)
# De aquí vienen los archivos
my_dir_rem # ESTO DEPENDE DE LO QUE ESTÁ EN 1extras_precarga.r (PUEDE SER LOCAL/ONLINE)
# Estos son nuestros archivos disponibles
list.files(my_dir_rem)
# Creación de archivos
estima_imput_edgar(DIA = "0006",HORA = "1820")
# De aquí vienen los archivos
my_dir_rem # ESTO DEPENDE DE LO QUE ESTÁ EN 1extras_precarga.r (PUEDE SER LOCAL/ONLINE)
# Estos son nuestros archivos disponibles
list.files(my_dir_rem)
# Creación de archivos
estima_imput_edgar(DIA = "0006",HORA = "1840")
100+90+40
47+22+213
76+66+24
28+14+183
35.8+6+3.3
(2.9+3.3)/2 + (5.3+6)/2 + (34.8+35.8)/2
118-84
48+41+204
35+41+190
# Tiempo de espera para actualizar la app
segundos_espera <- 50
# Directorios (SIEMPRE LOCAL) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Shiny
my_dir_fun_shiny <- "C:/R_Apps/OFICIAL_INT_INE_2021/SHINY/"
# Estimación
my_dir <- "C:/R_Apps/OFICIAL_INT_INE_2021/ESTIMACION/"
# Carga de funciones
source(paste0(my_dir_fun_shiny,"fun_edgar.R"),encoding = "UTF-8")
# PRE CARGA (SESGO)
source(paste0(my_dir, "1extras_precarga.r"),encoding = "utf-8")
# Carga de datos
load(paste0(my_dir_fun_shiny,"Intervalos.RData"))
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
tiempos
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
tiempos
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
tiempos
Intervalos$CONF$remesa
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
tiempos
substrLeft <- function(x, n){
substr(x, 1, n)
}
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
dias
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
tiempos
tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4)
tiempos %>% as.character() %>% stri_sub(1, 2)
tiempos %>% as.character() %>% stri_sub(3, 4)
paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":")
?hms::parse_hm
paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
tiempos
library(lubridate)
tiempos <-  day(tiempos)
tiempos
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
days(tiempos)
tiempos
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
tiempos <-  days(tiempos)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
days(tiempos)
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
dias
day(tiempos)
day(tiempos) <-  day(tiempos) + 1
tiempos
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
tiempos
day(tiempos) <-  day(tiempos) + 1
tiempos
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
days(tiempos) <-  days(tiempos) + as.numeric(dias)
as.numeric(dias)
days(tiempos)
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
days(tiempos) <-  days(tiempos) + as.numeric(dias)
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
tiempos
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
tiempos
days(tiempos) <-  days(tiempos) + 1 #as.numeric(dias)
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
day(tiempos) <-  day(tiempos) + as.numeric(dias)
tiempos
runApp()
min(tiempos)
max(tiempos)
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
day(tiempos) <-  day(tiempos) + as.numeric(dias)
tiempos
# Objetos a actualizar
try(load(paste0(my_dir_fun_shiny,"Intervalos.RData")))
# nombres de los archivos
archivos <<- Intervalos$Part$remesa
# Ajuste en los tiempos
Intervalos$CONF$remesa <- Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
Intervalos$CONF$remesa <- paste(Intervalos$CONF$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$CONF$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
Intervalos$CONF$remesa
# Objetos a actualizar
try(load(paste0(my_dir_fun_shiny,"Intervalos.RData")))
# nombres de los archivos
archivos <<- Intervalos$Part$remesa
Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
# Para sumarle los días
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
dias
# Ajuste en los tiempos
# Para sumarle los días
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
dias
Intervalos$CONF$remesa <- Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
Intervalos$CONF$remesa <- paste(Intervalos$CONF$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$CONF$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Los demás tienen el mismo formato y fechas
Intervalos$VVE$remesa  <- Intervalos$CONF$remesa
Intervalos$Part$remesa <- Intervalos$Part$remesa %>% substrRight(n = 4)
Intervalos$Part$remesa <- paste(Intervalos$Part$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$Part$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <-  unique(Intervalos$CONF$remesa) %>% convierte_hora()
tiempos
# Ajuste en los tiempos
# Para sumarle los días************************
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
Intervalos$CONF$remesa <- Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
Intervalos$CONF$remesa <- paste(Intervalos$CONF$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$CONF$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Los demás tienen el mismo formato y fechas
Intervalos$VVE$remesa  <- Intervalos$CONF$remesa
Intervalos$Part$remesa <- Intervalos$Part$remesa %>% substrRight(n = 4)
Intervalos$Part$remesa <- paste(Intervalos$Part$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$Part$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <-  unique(Intervalos$CONF$remesa) %>% convierte_hora()
# Para sumarle los días*************************
day(tiempos) <-  day(tiempos) + as.numeric(dias)
dias
# Objetos a actualizar
try(load(paste0(my_dir_fun_shiny,"Intervalos.RData")))
# nombres de los archivos
archivos <<- Intervalos$Part$remesa
# Ajuste en los tiempos
# Para sumarle los días************************
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
Intervalos$CONF$remesa <- Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
Intervalos$CONF$remesa <- paste(Intervalos$CONF$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$CONF$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Los demás tienen el mismo formato y fechas
Intervalos$VVE$remesa  <- Intervalos$CONF$remesa
Intervalos$Part$remesa <- Intervalos$Part$remesa %>% substrRight(n = 4)
Intervalos$Part$remesa <- paste(Intervalos$Part$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$Part$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <-  unique(Intervalos$CONF$remesa) %>% convierte_hora()
# Para sumarle los días*************************
day(tiempos) <-  day(tiempos) + as.numeric(dias)
tiempos
# Selección de partidos
CONF <- Intervalos$CONF[Intervalos$CONF$Partido %in% input$partidos_CONF,]
# Carga de datos
load(paste0(my_dir_fun_shiny,"Intervalos.RData"))
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
# Para sumarle los días
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
day(tiempos) <-  day(tiempos) + as.numeric(dias)
# Ajuste en los tiempos
# Para sumarle los días************************
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
Intervalos$CONF$remesa <- Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
Intervalos$CONF$remesa <- paste(Intervalos$CONF$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$CONF$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Los demás tienen el mismo formato y fechas
Intervalos$VVE$remesa  <- Intervalos$CONF$remesa
Intervalos$Part$remesa <- Intervalos$Part$remesa %>% substrRight(n = 4)
Intervalos$Part$remesa <- paste(Intervalos$Part$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$Part$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos
tiempos <-  unique(Intervalos$CONF$remesa) %>% convierte_hora()
tiempos
# Para sumarle los días*************************
day(tiempos) <-  day(tiempos) + as.numeric(dias)
dias
# Tiempo de espera para actualizar la app
segundos_espera <- 50
# Directorios (SIEMPRE LOCAL) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Shiny
my_dir_fun_shiny <- "C:/R_Apps/OFICIAL_INT_INE_2021/SHINY/"
# Estimación
my_dir <- "C:/R_Apps/OFICIAL_INT_INE_2021/ESTIMACION/"
# Carga de funciones
source(paste0(my_dir_fun_shiny,"fun_edgar.R"),encoding = "UTF-8")
# PRE CARGA (SESGO)
source(paste0(my_dir, "1extras_precarga.r"),encoding = "utf-8")
# Carga de datos
load(paste0(my_dir_fun_shiny,"Intervalos.RData"))
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 4) %>% unique()
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(1, 2),tiempos %>% as.character() %>% stri_sub(3, 4),sep = ":") %>% convierte_hora()
tiempos
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
partidos
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% unique()
tiempos
dias <- tiempos %>% substrLeft(n = 4)
dias
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(5, 6),tiempos %>% as.character() %>% stri_sub(7, 8),sep = ":") %>% convierte_hora()
tiempos
# Para sumarle los días
day(tiempos) <-  day(tiempos) + as.numeric(dias)
tiempos
# Para sumarle los días
day(tiempos) <-  (day(tiempos) + as.numeric(dias)) %>% unique()
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% unique()
dias <- tiempos %>% substrLeft(n = 4)
tiempos <- paste(tiempos %>% as.character() %>% stri_sub(5, 6),tiempos %>% as.character() %>% stri_sub(7, 8),sep = ":") %>% convierte_hora()
# Para sumarle los días
day(tiempos) <-  (day(tiempos) + as.numeric(dias)) %>% unique()
tiempos
# Objetos a actualizar
try(load(paste0(my_dir_fun_shiny,"Intervalos.RData")))
# nombres de los archivos
archivos <<- Intervalos$Part$remesa
Intervalos$CONF$remesa
# Ajuste en los tiempos
# Para sumarle los días************************
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4) %>% unique()
dias
# Ajuste en los tiempos
# Para sumarle los días************************
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4)
dias
Intervalos$CONF$remesa <- Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
Intervalos$CONF$remesa
Intervalos$CONF$remesa <- paste(Intervalos$CONF$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$CONF$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
Intervalos$CONF$remesa
# Los demás tienen el mismo formato y fechas
Intervalos$VVE$remesa  <- Intervalos$CONF$remesa
Intervalos$Part$remesa
# Para la remesa
dias_rem <- Intervalos$Part$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4)
dias_rem
Intervalos$Part$remesa <- Intervalos$Part$remesa %>% substrRight(n = 4)
Intervalos$Part$remesa <- paste(Intervalos$Part$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$Part$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
Intervalos$Part$remesa
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos
unique(Intervalos$CONF$remesa)
Intervalos$CONF$remesa
tiempos <- Intervalos$CONF$remesa %>% convierte_hora()
day(tiempos) <-  day(tiempos) + as.numeric(dias)
tiempos
tiempos <-  unique(tiempos)
tiempos
tiempos
tiempos_CONF
dia_hora
# Selección de partidos
CONF <- Intervalos$CONF[Intervalos$CONF$Partido %in% input$partidos_CONF,]
input <- list()
input$partidos_CONF <- "PAN"
# Selección de partidos
CONF <- Intervalos$CONF[Intervalos$CONF$Partido %in% input$partidos_CONF,]
CONF
# Selección de tiempos
dia_hora <- convierte_hora(CONF$remesa)
dia_hora
tiempos
# Objetos a actualizar
try(load(paste0(my_dir_fun_shiny,"Intervalos.RData")))
# nombres de los archivos
archivos <<- Intervalos$Part$remesa
# Ajuste en los tiempos
# Para sumarle los días************************
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4)
Intervalos$CONF$remesa <- Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
Intervalos$CONF$remesa <- paste(Intervalos$CONF$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$CONF$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Los demás tienen el mismo formato y fechas
Intervalos$VVE$remesa  <- Intervalos$CONF$remesa
# Para la remesa
dias_rem <- Intervalos$Part$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4)
Intervalos$Part$remesa <- Intervalos$Part$remesa %>% substrRight(n = 4)
Intervalos$Part$remesa <- paste(Intervalos$Part$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$Part$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
Intervalos$Part$remesa
dias_rem
Intervalos$Part$remesa
Intervalos$Part
Intervalos$Part <- cbind(D=dias_rem,Intervalos$Part) %>% as.data.frame()
Intervalos$Part
# Objetos a actualizar
try(load(paste0(my_dir_fun_shiny,"Intervalos.RData")))
# nombres de los archivos
archivos <<- Intervalos$Part$remesa
# Ajuste en los tiempos
# Para sumarle los días************************
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4)
Intervalos$CONF$remesa <- Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
Intervalos$CONF$remesa <- paste(Intervalos$CONF$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$CONF$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
# Los demás tienen el mismo formato y fechas
Intervalos$VVE$remesa  <- Intervalos$CONF$remesa
# Para la remesa
dias_rem <- Intervalos$Part$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4)
Intervalos$Part$remesa <- Intervalos$Part$remesa %>% substrRight(n = 4)
Intervalos$Part$remesa <- paste(Intervalos$Part$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$Part$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
Intervalos$Part <- cbind(Day=dias_rem,Intervalos$Part) %>% as.data.frame()
# Variables para Shiny
# Estas las tomamos de CONF... hasta ahora sin pérdida de generalidad.
partidos <- unique(Intervalos$CONF$Partido)
tiempos <- Intervalos$CONF$remesa %>% convierte_hora()
day(tiempos) <-  day(tiempos) + as.numeric(dias)
tiempos <-  unique(tiempos)
Intervalos$Part
# Objetos a actualizar
try(load(paste0(my_dir_fun_shiny,"Intervalos.RData")))
# nombres de los archivos
archivos <<- Intervalos$Part$remesa
# Ajuste en los tiempos
# Para sumarle los días************************
dias <- Intervalos$CONF$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4)
Intervalos$CONF$remesa <- Intervalos$CONF$remesa %>% substrRight(n = 4) #%>% unique()
Intervalos$CONF$remesa <- paste(Intervalos$CONF$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$CONF$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
Intervalos$CONF <- cbind(Day=dias,Intervalos$CONF) %>% as.data.frame()
Intervalos$CONF
# Los demás tienen el mismo formato y fechas
Intervalos$VVE$remesa  <- Intervalos$CONF$remesa
Intervalos$VVE <- cbind(Day=dias,Intervalos$VVE) %>% as.data.frame()
Intervalos$VVE
# Para la remesa
dias_rem <- Intervalos$Part$remesa %>% substrRight(n = 8) %>% substrLeft(n = 4)
Intervalos$Part$remesa <- Intervalos$Part$remesa %>% substrRight(n = 4)
Intervalos$Part$remesa <- paste(Intervalos$Part$remesa %>% as.character() %>% stri_sub(1, 2),Intervalos$Part$remesa %>% as.character() %>% stri_sub(3, 4),sep = ":")
Intervalos$Part <- cbind(Day=dias_rem,Intervalos$Part) %>% as.data.frame()
Intervalos$Part
# Selección de partidos
CONF <- Intervalos$CONF[Intervalos$CONF$Partido %in% input$partidos_CONF,]
CONF
# Selección de tiempos
dia_hora <- convierte_hora(CONF$remesa)
dia_hora
runApp()
runApp()
runApp()
source('C:/R_Apps/OFICIAL_INT_INE_2021/SHINY/Actualiza_Intervalos.R', encoding = 'UTF-8', echo=TRUE)
runApp()
